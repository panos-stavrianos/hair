"use strict";!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){!function(t){function e(t,e,o,r,i,a){var h=(a-e)*(o-t)-(r-e)*(i-t);return h>0||!(h<0)}function o(t,o,r,i,a,h,n,s){return e(t,o,a,h,n,s)!==e(r,i,a,h,n,s)&&e(t,o,r,i,a,h)!==e(t,o,r,i,n,s)}function r(t,e,r,i,a,h,n,s){return o(t,e,t+r,e,a,h,n,s)||o(t+r,e,t+r,e+i,a,h,n,s)||o(t,e+i,t+r,e+i,a,h,n,s)||o(t,e,t,e+i,a,h,n,s)}function i(e){var o=this,r=Math.max(t.animObject(o.renderer.globalAnimation).duration,250),i=!o.hasRendered;e.apply(o,[].slice.call(arguments,1)),o.labelSeries=[],o.labelSeriesMaxSum=0,clearTimeout(o.seriesLabelTimer),n(o.series,function(e){var a=e.options.label,h=e.labelBySeries,n=h&&h.closest;a.enabled&&e.visible&&(e.graph||e.area)&&!e.isSeriesBoosting&&(o.labelSeries.push(e),a.minFontSize&&a.maxFontSize&&(e.sum=t.reduce(e.yData,function(t,e){return(t||0)+(e||0)},0),o.labelSeriesMaxSum=Math.max(o.labelSeriesMaxSum,e.sum)),i&&(r=Math.max(r,t.animObject(e.options.animation).duration)),n&&(n[0].plotX!==undefined?h.animate({x:n[0].plotX+n[1],y:n[0].plotY+n[2]}):h.attr({opacity:0})))}),o.seriesLabelTimer=t.syncTimeout(function(){o.drawSeriesLabels()},o.renderer.forExport?0:r)}var a=3,h=t.wrap,n=t.each,s=t.extend,c=t.isNumber,l=t.pick,p=t.Series,u=t.SVGRenderer,d=t.Chart;t.setOptions({plotOptions:{series:{label:{enabled:!0,connectorAllowed:!0,connectorNeighbourDistance:24,minFontSize:null,maxFontSize:null,onArea:null,style:{fontWeight:"bold"},boxesToAvoid:[]}}}}),u.prototype.symbols.connector=function(t,e,o,r,i){var a,h,n=i&&i.anchorX,s=i&&i.anchorY,l=o/2;return c(n)&&c(s)&&(a=["M",n,s],(h=e-s)<0&&(h=-r-h),h<o&&(l=n<t+o/2?h:o-h),s>e+r?a.push("L",t+l,e+r):s<e?a.push("L",t+l,e):n<t?a.push("L",t,e+r/2):n>t+o&&a.push("L",t+o,e+r/2)),a||[]},p.prototype.getPointsOnGraph=function(){if(this.xAxis||this.yAxis){var t,e,o,r,i,a,h,n,s,p,u=16,d=this.points,x=[],b=this.graph||this.area,f=b.element,g=this.chart.inverted,y=this.xAxis,m=this.yAxis,Y=g?m.pos:y.pos,X=g?y.pos:m.pos,w=l(this.options.label.onArea,!!this.area),A=m.getThreshold(this.options.threshold);if(this.getPointSpline&&f.getPointAtLength&&!w){for(b.toD&&(p=b.attr("d"),b.attr({d:b.toD})),h=f.getTotalLength(),o=0;o<h;o+=u)t=f.getPointAtLength(o),x.push({chartX:Y+t.x,chartY:X+t.y,plotX:t.x,plotY:t.y});p&&b.attr({d:p}),(t=d[d.length-1]).chartX=Y+t.plotX,t.chartY=X+t.plotY,x.push(t)}else for(h=d.length,o=0;o<h;o+=1){if(t=d[o],e=d[o-1],t.chartX=Y+t.plotX,t.chartY=X+t.plotY,w&&(t.chartCenterY=X+(t.plotY+l(t.yBottom,A))/2),o>0&&(r=Math.abs(t.chartX-e.chartX),i=Math.abs(t.chartY-e.chartY),(a=Math.max(r,i))>u))for(n=Math.ceil(a/u),s=1;s<n;s+=1)x.push({chartX:e.chartX+(t.chartX-e.chartX)*(s/n),chartY:e.chartY+(t.chartY-e.chartY)*(s/n),chartCenterY:e.chartCenterY+(t.chartCenterY-e.chartCenterY)*(s/n),plotX:e.plotX+(t.plotX-e.plotX)*(s/n),plotY:e.plotY+(t.plotY-e.plotY)*(s/n)});c(t.plotY)&&x.push(t)}return x}},p.prototype.labelFontSize=function(t,e){return t+this.sum/this.chart.labelSeriesMaxSum*(e-t)+"px"},p.prototype.checkClearPoint=function(t,e,o,i){function a(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}function h(t,e){return t-e}var n,s,c,p,u,d,x,b,f,g=Number.MAX_VALUE,y=Number.MAX_VALUE,m=this.options.label.connectorAllowed,Y=l(this.options.label.onArea,!!this.area),X=this.chart,w=16;for(b=0;b<X.boxesToAvoid.length;b+=1)if(a(X.boxesToAvoid[b],{left:t,right:t+o.width,top:e,bottom:e+o.height}))return!1;for(b=0;b<X.series.length;b+=1)if(p=(c=X.series[b]).interpolatedPoints,c.visible&&p){for(f=1;f<p.length;f+=1){if(p[f].chartX>=t-w&&p[f-1].chartX<=t+o.width+w){if(r(t,e,o.width,o.height,p[f-1].chartX,p[f-1].chartY,p[f].chartX,p[f].chartY))return!1;this===c&&!u&&i&&(u=r(t-w,e-w,o.width+2*w,o.height+2*w,p[f-1].chartX,p[f-1].chartY,p[f].chartX,p[f].chartY))}!m&&!u||this===c&&!Y||(d=t+o.width/2-p[f].chartX,x=e+o.height/2-p[f].chartY,g=Math.min(g,d*d+x*x))}if(!Y&&m&&this===c&&(i&&!u||g<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(f=1;f<p.length;f+=1)(n=Math.min(Math.pow(t+o.width/2-p[f].chartX,2)+Math.pow(e+o.height/2-p[f].chartY,2),Math.pow(t-p[f].chartX,2)+Math.pow(e-p[f].chartY,2),Math.pow(t+o.width-p[f].chartX,2)+Math.pow(e-p[f].chartY,2),Math.pow(t+o.width-p[f].chartX,2)+Math.pow(e+o.height-p[f].chartY,2),Math.pow(t-p[f].chartX,2)+Math.pow(e+o.height-p[f].chartY,2)))<y&&(y=n,s=p[f]);u=!0}}return!(i&&!u)&&{x:t,y:e,weight:h(g,s?y:0),connectorPoint:s}},d.prototype.drawSeriesLabels=function(){var t=this,e=this.labelSeries;t.boxesToAvoid=[],n(e,function(e){e.interpolatedPoints=e.getPointsOnGraph(),n(e.options.label.boxesToAvoid||[],function(e){t.boxesToAvoid.push(e)})}),n(t.series,function(e){function o(t,e,o){return t>b&&t<=b+g-o.width&&e>=f&&e<=f+y-o.height}if(e.xAxis||e.yAxis){var r,i,h,n,c,p,u=[],d=e.options.label,x=t.inverted,b=x?e.yAxis.pos:e.xAxis.pos,f=x?e.xAxis.pos:e.yAxis.pos,g=t.inverted?e.yAxis.len:e.xAxis.len,y=t.inverted?e.xAxis.len:e.yAxis.len,m=e.interpolatedPoints,Y=l(d.onArea,!!e.area),X=e.labelBySeries,w=d.minFontSize,A=d.maxFontSize;if(e.visible&&!e.isSeriesBoosting&&m){for(X||(e.labelBySeries=X=t.renderer.label(e.name,0,-9999,"connector").css(s({color:Y?t.renderer.getContrast(e.color):e.color},e.options.label.style)),w&&A&&X.css({fontSize:e.labelFontSize(w,A)}),X.attr({padding:0,opacity:t.renderer.forExport?1:0,stroke:e.color,"stroke-width":1,zIndex:3}).add(e.group).animate({opacity:1},{duration:200})),(r=X.getBBox()).width=Math.round(r.width),c=m.length-1;c>0;c-=1)Y?(o(i=m[c].chartX-r.width/2,h=m[c].chartCenterY-r.height/2,r)&&(p=e.checkClearPoint(i,h,r)),p&&u.push(p)):(o(i=m[c].chartX+a,h=m[c].chartY-r.height-a,r)&&(p=e.checkClearPoint(i,h,r)),p&&u.push(p),o(i=m[c].chartX+a,h=m[c].chartY+a,r)&&(p=e.checkClearPoint(i,h,r)),p&&u.push(p),o(i=m[c].chartX-r.width-a,h=m[c].chartY+a,r)&&(p=e.checkClearPoint(i,h,r)),p&&u.push(p),o(i=m[c].chartX-r.width-a,h=m[c].chartY-r.height-a,r)&&(p=e.checkClearPoint(i,h,r)),p&&u.push(p));if(!u.length&&!Y)for(i=b+g-r.width;i>=b;i-=16)for(h=f;h<f+y-r.height;h+=16)(n=e.checkClearPoint(i,h,r,!0))&&u.push(n);if(u.length){u.sort(function(t,e){return e.weight-t.weight}),p=u[0],t.boxesToAvoid.push({left:p.x,right:p.x+r.width,top:p.y,bottom:p.y+r.height});var M=Math.sqrt(Math.pow(Math.abs(p.x-X.x),2),Math.pow(Math.abs(p.y-X.y),2));if(M){var S={opacity:t.renderer.forExport?1:0,x:p.x-b,y:p.y-f},v={opacity:1};M<=10&&(v={x:S.x,y:S.y},S={}),e.labelBySeries.attr(s(S,{anchorX:p.connectorPoint&&p.connectorPoint.plotX,anchorY:p.connectorPoint&&p.connectorPoint.plotY})).animate(v),e.options.kdNow=!0,e.buildKDTree();var P=e.searchPoint({chartX:p.x,chartY:p.y},!0);X.closest=[P,p.x-b-P.plotX,p.y-f-P.plotY]}}else X&&(e.labelBySeries=X.destroy())}}})},h(d.prototype,"render",i),h(d.prototype,"redraw",i)}(t)});