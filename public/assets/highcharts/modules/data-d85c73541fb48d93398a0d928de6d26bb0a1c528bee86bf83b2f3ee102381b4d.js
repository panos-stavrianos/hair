"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(e){!function(e){var t,n,r=e.win.document,i=e.each,s=e.objectEach,o=e.pick,a=e.inArray,l=e.isNumber,u=e.splat,d=e.fireEvent;t=Array.prototype.some?function(e,t,n){Array.prototype.some.call(e,t,n)}:function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(!0===t.call(n,e[r],r,e))return};var h=function(e,t){this.init(e,t)};e.extend(h.prototype,{init:function(e,t){this.options=e,this.chartOptions=t,this.columns=e.columns||this.rowsToColumns(e.rows)||[],this.firstRowAsNames=o(e.firstRowAsNames,!0),this.decimalRegex=e.decimalPoint&&new RegExp("^(-?[0-9]+)"+e.decimalPoint+"([0-9]+)$"),this.rawColumns=[],this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var t,r=this.chartOptions,o=this.options,a=[],l=function(t){return(e.seriesTypes[t||"line"].prototype.pointArrayMap||[0]).length},u=function(t){return e.seriesTypes[t||"line"].prototype.pointArrayMap},d=r&&r.chart&&r.chart.type,h=[],m=[],f=0;i(r&&r.series||[],function(e){h.push(l(e.type||d))}),i(o&&o.seriesMapping||[],function(e){a.push(e.x||0)}),0===a.length&&a.push(0),i(o&&o.seriesMapping||[],function(e){var i=new n,o=h[f]||l(d),a=(r&&r.series||[])[f]||{},p=u(a.type||d)||["y"];for(i.addColumnReader(e.x,"x"),s(e,function(e,t){"x"!==t&&i.addColumnReader(e,t)}),t=0;t<o;t++)i.hasReader(p[t])||i.addColumnReader(undefined,p[t]);m.push(i),f++});var p=u(d);p===undefined&&(p=["y"]),this.valueCount={global:l(d),xColumns:a,individual:h,seriesBuilders:m,globalPointArrayMap:p}},dataFound:function(){this.options.switchRowsAndColumns&&(this.columns=this.rowsToColumns(this.columns)),this.getColumnDistribution(),this.parseTypes(),!1!==this.parsed()&&this.complete()},parseCSV:function(n){function r(e,t,n,r){function i(t){d=e[t],h=e[t-1],m=e[t+1]}function s(e){x.length<c+1&&x.push([e]),x[c][x[c].length-1]!==e&&x[c].push(e)}function o(){if(g>p||p>y)return++p,void(f="");!isNaN(parseFloat(f))&&isFinite(f)?(f=parseFloat(f),s("number")):isNaN(Date.parse(f))?s("string"):(f=f.replace(/\//g,"-"),s("date")),a.length<c+1&&a.push([]),n||(a[c][t]=f),f="",++c,++p}var u=0,d="",h="",m="",f="",p=0,c=0;if(e.trim().length&&"#"!==e.trim()[0]){for(;u<e.length;u++){if(i(u),"#"===d)return void o();if('"'===d)for(i(++u);u<e.length&&('"'!==d||'"'===h||'"'===m);)('"'!==d||'"'===d&&'"'!==h)&&(f+=d),i(++u);else r&&r[d]?r[d](d,f)&&o():d===l?o():f+=d}o()}}function i(e){var n=0,r=0,i=!1;return t(e,function(e,t){var i,s,o,a=!1,l="";if(t>13)return!0;for(var u=0;u<e.length;u++){if(i=e[u],s=e[u+1],o=e[u-1],"#"===i)return;if('"'===i)if(a){if('"'!==o&&'"'!==s){for(;" "===s&&u<e.length;)s=e[++u];"undefined"!=typeof C[s]&&C[s]++,a=!1}}else a=!0;else"undefined"!=typeof C[i]?(l=l.trim(),isNaN(Date.parse(l))&&!isNaN(l)&&isFinite(l)||C[i]++,l=""):l+=i;","===i&&r++,"."===i&&n++}}),i=C[";"]>C[","]?";":(C[","],C[";"],","),m.decimalPoint||(m.decimalPoint=n>r?".":",",h.decimalRegex=new RegExp("^(-?[0-9]+)"+m.decimalPoint+"([0-9]+)$")),i}function s(t,n){var r,i,s,o,a="YYYY/mm/dd",l=0,u=!1,f=[],p=[];for((!n||n>t.length)&&(n=t.length);l<n;l++)if("undefined"!=typeof t[l]&&t[l]&&t[l].length)for(r=t[l].trim().replace(/\//g," ").replace(/\-/g," ").split(" "),i=["","",""],o=0;o<r.length;o++)o<i.length&&(r[o]=parseInt(r[o],10),r[o]&&(p[o]=!p[o]||p[o]<r[o]?r[o]:p[o],"undefined"!=typeof f[o]?f[o]!==r[o]&&(f[o]=!1):f[o]=r[o],r[o]>31?r[o]<100?i[o]="YY":i[o]="YYYY":r[o]>12&&r[o]<=31?(i[o]="dd",u=!0):i[o].length||(i[o]="mm")));if(u){for(o=0;o<f.length;o++)!1!==f[o]?p[o]>12&&"YY"!==i[o]&&"YYYY"!==i[o]&&(i[o]="YY"):p[o]>12&&"mm"===i[o]&&(i[o]="dd");return s=i.join("/"),(m.dateFormats||h.dateFormats)[s]?s:(d("invalidDateFormat"),e.error("Could not deduce date format"),a)}return a}function o(){}var a,l,u,h=this,m=n||this.options,f=m.csv,p=m.startRow||0,c=m.endRow||Number.MAX_VALUE,g=m.startColumn||0,y=m.endColumn||Number.MAX_VALUE,v=0,x=[],C={",":0,";":0,"\t":0};if(a=this.columns=[],f){u=f.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(m.lineDelimiter||"\n"),(!p||p<0)&&(p=0),(!c||c>=u.length)&&(c=u.length-1),m.itemDelimiter?l=m.itemDelimiter:(l=null,l=i(u));var Y=0;for(v=p;v<=c;v++)"#"===u[v][0]?Y++:r(u[v],v-p-Y);o(),m.columnTypes&&0!==m.columnTypes.length||!x.length||!x[0].length||"date"!==x[0][1]||m.dateFormat||(m.dateFormat=s(a[0])),this.dataFound()}return a},parseTable:function(){var e=this.options,t=e.table,n=this.columns,s=e.startRow||0,o=e.endRow||Number.MAX_VALUE,a=e.startColumn||0,l=e.endColumn||Number.MAX_VALUE;t&&("string"==typeof t&&(t=r.getElementById(t)),i(t.getElementsByTagName("tr"),function(e,t){t>=s&&t<=o&&i(e.children,function(e,r){("TD"===e.tagName||"TH"===e.tagName)&&r>=a&&r<=l&&(n[r-a]||(n[r-a]=[]),n[r-a][t-s]=e.innerHTML)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var e,t,n=this,r=this.options,s=r.googleSpreadsheetKey,o=this.columns,a=r.startRow||0,l=r.endRow||Number.MAX_VALUE,u=r.startColumn||0,d=r.endColumn||Number.MAX_VALUE;s&&jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+s+"/"+(r.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",error:r.error,success:function(r){var s,h,m=r.feed.entry,f=m.length,p=0,c=0;for(h=0;h<f;h++)s=m[h],p=Math.max(p,s.gs$cell.col),c=Math.max(c,s.gs$cell.row);for(h=0;h<p;h++)h>=u&&h<=d&&(o[h-u]=[],o[h-u].length=Math.min(c,l-a));for(h=0;h<f;h++)s=m[h],e=s.gs$cell.row-1,(t=s.gs$cell.col-1)>=u&&t<=d&&e>=a&&e<=l&&(o[t-u][e-a]=s.content.$t);i(o,function(e){for(h=0;h<e.length;h++)e[h]===undefined&&(e[h]=null)}),n.dataFound()}})},trim:function(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[0-9\s]+$/.test(e)&&(e=e.replace(/\s/g,"")),this.decimalRegex&&(e=e.replace(this.decimalRegex,"$1.$2"))),e},parseTypes:function(){for(var e=this.columns,t=e.length;t--;)this.parseColumn(e[t],t)},parseColumn:function(e,t){var n,r,i,s,o,d,h,m=this.rawColumns,f=this.columns,p=e.length,c=this.firstRowAsNames,g=-1!==a(t,this.valueCount.xColumns),y=[],v=this.chartOptions,x=(this.options.columnTypes||[])[t],C=g&&(v&&v.xAxis&&"category"===u(v.xAxis)[0].type||"string"===x);for(m[t]||(m[t]=[]);p--;)n=y[p]||e[p],i=this.trim(n),s=this.trim(n,!0),r=parseFloat(s),m[t][p]===undefined&&(m[t][p]=i),C||0===p&&c?e[p]=""+i:+s===r?(e[p]=r,r>31536e6&&"float"!==x?e.isDatetime=!0:e.isNumeric=!0,e[p+1]!==undefined&&(h=r>e[p+1])):(o=this.parseDate(n),g&&l(o)&&"float"!==x?(y[p]=n,e[p]=o,e.isDatetime=!0,e[p+1]!==undefined&&((d=o>e[p+1])!==h&&h!==undefined&&(this.alternativeFormat?(this.dateFormat=this.alternativeFormat,p=e.length,this.alternativeFormat=this.dateFormats[this.dateFormat].alternative):e.unsorted=!0),h=d)):(e[p]=""===i?null:i,0!==p&&(e.isDatetime||e.isNumeric)&&(e.mixed=!0)));if(g&&e.mixed&&(f[t]=m[t]),g&&h&&this.options.sort)for(t=0;t<f.length;t++)f[t].reverse(),c&&f[t].unshift(f[t].pop())},dateFormats:{"YYYY/mm/dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{1,2})$/,parser:function(e){return Date.UTC(+e[1],e[2]-1,+e[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(e){return Date.UTC(+e[3],e[2]-1,+e[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(e){return Date.UTC(+e[3],e[1]-1,+e[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(e){var t=+e[3];return t>(new Date).getFullYear()-2e3?t+=1900:t+=2e3,Date.UTC(t,e[2]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[3]+2e3,e[1]-1,+e[2])}}},parseDate:function(e){var t,n,r,i,s=this.options.parseDate,o=this.options.dateFormat||this.dateFormat;if(s)t=s(e);else if("string"==typeof e){if(o)(r=this.dateFormats[o])||(r=this.dateFormats["YYYY/mm/dd"]),(i=e.match(r.regex))&&(t=r.parser(i));else for(n in this.dateFormats)if(r=this.dateFormats[n],i=e.match(r.regex)){this.dateFormat=o=n,this.alternativeFormat=r.alternative,t=r.parser(i);break}i||("object"==typeof(i=Date.parse(e))&&null!==i&&i.getTime?t=i.getTime()-6e4*i.getTimezoneOffset():l(i)&&(t=i-6e4*new Date(i).getTimezoneOffset()))}return t},rowsToColumns:function(e){var t,n,r,i,s;if(e)for(s=[],n=e.length,t=0;t<n;t++)for(i=e[t].length,r=0;r<i;r++)s[r]||(s[r]=[]),s[r][t]=e[t][r];return s},parsed:function(){if(this.options.parsed)return this.options.parsed.call(this,this.columns)},getFreeIndexes:function(e,t){var n,r,i,s=[],o=[];for(r=0;r<e;r+=1)s.push(!0);for(n=0;n<t.length;n+=1)for(i=t[n].getReferencedColumnIndexes(),r=0;r<i.length;r+=1)s[i[r]]=!1;for(r=0;r<s.length;r+=1)s[r]&&o.push(r);return o},complete:function(){var e,t,r,i,s,o,l,u,d,h,m,f,p=this.columns,c=[],g=this.options,y=[];if(c.length=p.length,g.complete||g.afterComplete){for(i=0;i<p.length;i++)this.firstRowAsNames&&(p[i].name=p[i].shift());for(t=[],h=this.getFreeIndexes(p.length,this.valueCount.seriesBuilders),l=0;l<this.valueCount.seriesBuilders.length;l++)(d=this.valueCount.seriesBuilders[l]).populateColumns(h)&&y.push(d);for(;h.length>0;){for((d=new n).addColumnReader(0,"x"),-1!==(f=a(0,h))&&h.splice(f,1),i=0;i<this.valueCount.global;i++)d.addColumnReader(undefined,this.valueCount.globalPointArrayMap[i]);d.populateColumns(h)&&y.push(d)}if(y.length>0&&y[0].readers.length>0&&(m=p[y[0].readers[0].columnIndex])!==undefined&&(m.isDatetime?e="datetime":m.isNumeric||(e="category")),"category"===e)for(l=0;l<y.length;l++)for(d=y[l],o=0;o<d.readers.length;o++)"x"===d.readers[o].configName&&(d.readers[o].configName="name");for(l=0;l<y.length;l++){for(d=y[l],r=[],s=0;s<p[0].length;s++)r[s]=d.read(p,s);t[l]={data:r},d.name&&(t[l].name=d.name),"category"===e&&(t[l].turboThreshold=0)}u={series:t},e&&(u.xAxis={type:e},"category"===e&&(u.xAxis.uniqueNames=!1)),g.complete&&g.complete(u),g.afterComplete&&g.afterComplete(u)}},update:function(t,n){var r=this.chart;t&&(t.afterComplete=function(e){r.update(e,n)},e.data(t))}}),e.Data=h,e.data=function(e,t){return new h(e,t)},e.wrap(e.Chart.prototype,"init",function(t,n,r){var i=this;n&&n.data?(i.data=new h(e.extend(n.data,{afterComplete:function(s){var o,a;if(n.hasOwnProperty("series"))if("object"==typeof n.series)for(o=Math.max(n.series.length,s.series.length);o--;)a=n.series[o]||{},n.series[o]=e.merge(a,s.series[o]);else delete n.series;n=e.merge(s,n),t.call(i,n,r)}}),n),i.data.chart=i):t.call(i,n,r)}),(n=function(){this.readers=[],this.pointIsArray=!0}).prototype.populateColumns=function(e){var t=this,n=!0;return i(t.readers,function(t){t.columnIndex===undefined&&(t.columnIndex=e.shift())}),i(t.readers,function(e){e.columnIndex===undefined&&(n=!1)}),n},n.prototype.read=function(e,t){var n,r=this,s=r.pointIsArray,o=s?[]:{};return i(r.readers,function(n){var r=e[n.columnIndex][t];s?o.push(r):o[n.configName]=r}),this.name===undefined&&r.readers.length>=2&&(n=r.getReferencedColumnIndexes()).length>=2&&(n.shift(),n.sort(),this.name=e[n.shift()].name),o},n.prototype.addColumnReader=function(e,t){this.readers.push({columnIndex:e,configName:t}),"x"!==t&&"y"!==t&&t!==undefined&&(this.pointIsArray=!1)},n.prototype.getReferencedColumnIndexes=function(){var e,t,n=[];for(e=0;e<this.readers.length;e+=1)(t=this.readers[e]).columnIndex!==undefined&&n.push(t.columnIndex);return n},n.prototype.hasReader=function(e){var t;for(t=0;t<this.readers.length;t+=1)if(this.readers[t].configName===e)return!0}}(e)});