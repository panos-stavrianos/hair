(function(){this.EffectiveForm||(this.EffectiveForm=new(function(){function t(){}return t.prototype.current_submit="",t.prototype.current_delete="",t.prototype.remote_form_commit="",t.prototype.remote_form_payload="",t.prototype.remote_form_flash="",t.prototype.validate=function(t){var e,r;return r=t.checkValidity(),e=$(t),this.clearFlash(),e.hasClass("was-validated")&&this.reset(e),r?this.submitting(e):this.invalidate(e),r},t.prototype.submitting=function(t){if(t.addClass("form-is-valid").removeClass("form-is-invalid"),this.spin(),setTimeout(function(){return EffectiveForm.disable(t)},0),"get"===(t.attr("method")||"").toLowerCase()||this.current_submit.length>0&&this.current_submit.hasClass("form-actions-reset"))return setTimeout(function(){return EffectiveForm.reset(t)},2500)},t.prototype.invalidate=function(t){return t.addClass("was-validated").addClass("form-is-invalid"),t.find(".form-current-submit").removeClass("form-current-submit"),t.find(".effective-radios:not(.no-feedback),.effective-checks:not(.no-feedback)").each(function(){return $(this).addClass($(this).find("input:invalid").length>0?"is-invalid":"is-valid")}),this.flash(t,"danger")},t.prototype.disable=function(t){return t.find("[type=submit]").prop("disabled",!0)},t.prototype.reset=function(t){return t.is("form")||(t=t.closest("form")),t.removeClass("was-validated").removeClass("form-is-invalid").removeClass("form-is-valid"),t.find(".form-current-submit").removeClass("form-current-submit"),t.find(".alert.is-invalid").remove(),t.find(".is-invalid").removeClass("is-invalid"),t.find(".is-valid").removeClass("is-valid"),t.find("[type=submit]").removeAttr("disabled"),t},t.prototype.clear=function(t){return t.find("input").not(":button, :submit, :reset, :hidden, :checkbox, :radio").val(""),t.find("textarea").val(""),t.find("select").val("").trigger("change.select2"),t.find("input[type=checkbox],input[type=radio]").prop("checked",!1).trigger("change")},t.prototype.spin=function(){if(this.current_submit.length>0)return this.current_submit.addClass("form-current-submit")},t.prototype.beforeAjax=function(t){if(t.data("remote"))return t.one("ajax:success",function(t){return EffectiveForm.loadFromAjax($(t.target),"delete"===$(t.target).data("method"))}),t.one("ajax:error",function(t,e,r,i){return EffectiveForm.reset($(t.target)),EffectiveForm.flash($(t.target),"danger",r+": "+(i||"unable to contact server. please refresh the page and try again."))})},t.prototype.loadFromAjax=function(t,e){var r,i,o,n,s;if(t.is("form")||(t=t.closest("form")),r="",this.remote_form_payload.length>0&&(0===(r=(i=$("<div>"+this.remote_form_payload+"</div>")).find("form[data-remote-index='"+t.data("remote-index")+"']")).length&&(r=i.find("form").first()),r.attr("data-remote",!0),this.remote_form_payload=""),!e)return r.length>0?(EffectiveBootstrap.initialize(r),t.replaceWith(r)):r=this.reset(t),this.current_submit.length>0&&(this.current_submit=r.find("#"+this.current_submit.attr("id")+".form-actions")),n="success",o="",this.remote_form_flash.length>0&&(n=this.remote_form_flash[0][0],o=this.remote_form_flash[0][1]),this.flash(r,n,o,!0),(s=r.hasClass("with-errors")||"danger"===n||"error"===n)?r.trigger("effective-form:error",[o,this.remote_form_commit]):r.trigger("effective-form:success",[o,this.remote_form_commit]),r.trigger("effective-form:complete",this.remote_form_commit,[o,this.remote_form_commit,s]),this.remote_form_flash="",this.remote_form_commit="",this.current_submit="",!0},t.prototype.flash=function(t,e,r,i){if(null==i&&(i=!1),this.current_submit.length>0)return"danger"===e||"error"===e?this.current_submit.find(".eb-icon-x").show().delay(1e3).fadeOut("slow",function(){return t.trigger("effective-form:error-animation-done",this.remote_form_commit,r)}):this.current_submit.find(".eb-icon-check").show().delay(1e3).fadeOut("slow",function(){return t.trigger("effective-form:success-animation-done",this.remote_form_commit,r)}),null==r||"success"===e&&i?void 0:this.current_submit.prepend(this.buildFlash(e,r))},t.prototype.clearFlash=function(){if(this.current_submit.length>0)return this.current_submit.find(".alert").remove()},t.prototype.buildFlash=function(t,e){return $("<div class='effective-form-flash alert alert-dismissable alert-"+t+" fade show' role='alert'> "+e+" <button class='close' type='button' aria-label='Close' data-dismiss='alert'> <span aria-hidden='true'>&times;</span> </button> </div>")},t.prototype.setCurrentSubmit=function(t){return t.is(".form-actions")?this.current_submit=t:this.current_submit=""},t.prototype.setCurrentDelete=function(t){return this.current_delete=t},t.prototype.clearCurrentSubmit=function(){return this.current_submit=""},t.prototype.finishDelete=function(){if(this.current_delete.length>0)return this.current_delete.fadeOut("slow",function(){return $(this).remove()}),this.current_delete=""},t}())),$(document).on("click",".form-actions a[data-remote],.form-actions button[type=submit]",function(){return EffectiveForm.setCurrentSubmit($(this).parent()),EffectiveForm.spin()}),$(document).on("ajax:beforeSend","form[data-remote]",function(){return EffectiveForm.beforeAjax($(this)),this.checkValidity()}),$(document).on("ajax:beforeSend","[data-method=delete]",function(){var t;if((t=$(this)).data("closest"))return EffectiveForm.setCurrentDelete(t.closest(t.data("closest")))}),$(document).on("reset","form",function(t){var e;return e=$(t.currentTarget),EffectiveForm.reset(e)}),$(document).on("clear","form",function(t){var e;return e=$(t.currentTarget),EffectiveForm.reset(e),setTimeout(function(){return EffectiveForm.clear(e)})})}).call(this);